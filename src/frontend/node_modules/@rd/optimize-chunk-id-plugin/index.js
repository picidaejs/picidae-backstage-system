/**
 * @file: index
 * @author: Cuttle Cong
 * @date: 2017/12/11
 * @description:
 */

function OptimizeChunkId() {
}

OptimizeChunkId.prototype.apply = function apply(compiler) {
  var options = Object.assign({
    len: 4
  }, this.options)
  compiler.plugin('compilation', function (compilation) {
    compilation.plugin('optimize-chunk-ids', (chunks) => {
      chunks.forEach(function (chunk) {
        console.log(chunk)
      })
    })

    compilation.plugin('chunk-hash', function (chunk, chunkHash) {
      var origin = chunkHash.digest
      chunkHash.digest = function () {
        return origin.apply(chunkHash, arguments).slice(0, options.len)
      }
    })

  })
}

module.exports = OptimizeChunkId