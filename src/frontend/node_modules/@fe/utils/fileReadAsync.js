/**
 * @file: fileReadAsync
 * @author: Cuttle Cong
 * @date: 2017/12/15
 * @description:
 */

module.exports = function (source, options = {}) {
  const { readAs = 'Text' } = options
  const fr = new FileReader()

  const readAsName = `readAs${readAs}`
  const readAsMethod = fr[readAsName]
  if (typeof readAsMethod === 'function') {
    readAsMethod.call(fr, source)
  } else {
    throw new Error('the method named: ' + readAsName + ' is not existed')
  }

  return new Promise(function (resolve, reject) {
    fr.onloadend = function () {
      resolve(fr)
    }
    fr.onerror = reject
  })
}
