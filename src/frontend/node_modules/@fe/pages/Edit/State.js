/**
 * @file: State
 * @author: Cuttle Cong
 * @date: 2017/12/11
 * @description: $END$
 */

import { action, observable } from '@fe/utils/decorator'
import Root from '@fe/utils/models/Root'

export default class State extends Root {
  @observable tree = {}
  @observable fileContent = ''

  // @observable active

  @action
  async fetchTree() {
    const progress = function (received, total) {
      console.log(received, total)
    }
    const { data, code } = await fetch('/api/fileView/get', { progress })
    if (code === 200) {
      const newData = { tree: data.tree }
      if (typeof data.fileContent === 'string') {
        newData.fileContent = data.fileContent
      }
      this.assignShallow(newData)
      // this.active = data.active
    }
  }

  @action init(/*props*/) {
    this.fetchTree()
  }

  @action update(/*props*/) {
  }

  @action exit() {
  }
}